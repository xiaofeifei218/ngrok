# 开发环境配置 - 无需 TLS 证书，快速启动

services:
  ngrokd:
    build: .
    container_name: ngrokd-dev
    restart: unless-stopped

    environment:
      # 开发环境使用 ngrok.me（需要配置 hosts）
      - DOMAIN=ngrok.me
      # 不使用 TLS（仅用于开发）
      - TLS_KEY=
      - TLS_CRT=

    ports:
      - "4443:4443"  # 客户端连接端口
      - "8080:80"    # HTTP 隧道 - 使用 8080 避免权限问题
      - "8443:443"   # HTTPS 隧道 - 使用 8443

    networks:
      - ngrok-dev

networks:
  ngrok-dev:
    driver: bridge

# 使用方法:
# 1. 配置 /etc/hosts:
#    sudo echo "127.0.0.1 ngrok.me" >> /etc/hosts
#    sudo echo "127.0.0.1 test.ngrok.me" >> /etc/hosts
#
# 2. 启动服务:
#    docker-compose -f docker-compose.dev.yml up
#
# 3. 客户端配置 ~/.ngrok:
#    server_addr: ngrok.me:4443
#    trust_host_root_certs: false
#
# 4. 连接测试:
#    ./bin/ngrok -config=~/.ngrok -subdomain=test 8080
